title: python3中unicode编码解码
date: 2019-08-31 15:53:09
tags: [python,unicode]
---
举个例子:
```
http-title: \xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93
```
此处的`\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93`既是字符串的UTF-8编码,那么
```
In [1]: b"\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93".decode("utf-8")
Out[1]: '百度一下，你就知道'
```
然而对于格式不是byte的字符串来说,python3的默认的编码是utf-8,导致encode出的是utf-8编码,此时只需要手动指定latin1方式解码为byte即可
```
In [2]: u"\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93".encode()
Out[2]: b'\xc3\xa7\xc2\x99\xc2\xbe\xc3\xa5\xc2\xba\xc2\xa6\xc3\xa4\xc2\xb8\xc2\x80\xc3\xa4\xc2\xb8\xc2\x8b\xc3\xaf\xc2\xbc\xc2\x8c\xc3\xa4\xc2\xbd\xc2\xa0\xc3\xa5\xc2\xb0\xc2\xb1\xc3\xa7\xc2\x9f\xc2\xa5\xc3\xa9\xc2\x81\xc2\x93'

In [3]: u"\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93".encode("latin1")
Out[3]: b'\xe7\x99\xbe\xe5\xba\xa6\xe4\xb8\x80\xe4\xb8\x8b\xef\xbc\x8c\xe4\xbd\xa0\xe5\xb0\xb1\xe7\x9f\xa5\xe9\x81\x93'

In [4]: u"\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93".encode("latin1").decode("utf-8")
Out[4]: '百度一下，你就知道'
```
对于使用默认方式从文本中读出的字符串来说,`\`为了防止转义会变成`\\`,此时需要使用`unicode_escape`相互转换处理即可.(这里让我搞了许久,之前的解决方法是上正则匹配`\x`与`\u`开头的字符串)
```
In [11]: x=""
    ...: with open(r"d:\u.txt") as f:
    ...:     x=f.read()
    ...:     print(x)
    ...:
\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93

In [12]: x
Out[12]: '\\xE7\\x99\\xBE\\xE5\\xBA\\xA6\\xE4\\xB8\\x80\\xE4\\xB8\\x8B\\xEF\\xBC\\x8C\\xE4\\xBD\\xA0\\xE5\\xB0\\xB1\\xE7\\x9F\\xA5\\xE9\\x81\\x93'

In [13]: x.encode()
Out[13]: b'\\xE7\\x99\\xBE\\xE5\\xBA\\xA6\\xE4\\xB8\\x80\\xE4\\xB8\\x8B\\xEF\\xBC\\x8C\\xE4\\xBD\\xA0\\xE5\\xB0\\xB1\\xE7\\x9F\\xA5\\xE9\\x81\\x93'

In [19]: u"\xE7\x99\xBE\xE5\xBA\xA6\xE4\xB8\x80\xE4\xB8\x8B\xEF\xBC\x8C\xE4\xBD\xA0\xE5\xB0\xB1\xE7\x9F\xA5\xE9\x81\x93".encode("unicode_escape")
Out[19]: b'\\xe7\\x99\\xbe\\xe5\\xba\\xa6\\xe4\\xb8\\x80\\xe4\\xb8\\x8b\\xef\\xbc\\x8c\\xe4\\xbd\\xa0\\xe5\\xb0\\xb1\\xe7\\x9f\\xa5\\xe9\\x81\\x93'

In [14]: x.encode().decode("unicode_escape").encode("latin1")
Out[14]: b'\xe7\x99\xbe\xe5\xba\xa6\xe4\xb8\x80\xe4\xb8\x8b\xef\xbc\x8c\xe4\xbd\xa0\xe5\xb0\xb1\xe7\x9f\xa5\xe9\x81\x93'

In [15]: x.encode().decode("unicode_escape").encode("latin1").decode("utf-8")
Out[15]: '百度一下，你就知道'

```